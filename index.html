<!DOCTYPE HTML>
<html>
<head>
    <title>Pacman</title>
    <meta charset="utf-8">
    <style>
        body {
            margin: 0;
            padding: 0;
                background-image: url("data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxMTEhUTExMWFhUXFxgaGBgYGBoZGhgYGhoaGhseGh0YHyggGh0lGxgXITEhJykrLy4uGB8zODMtNygtLisBCgoKDg0OGhAQGi0lHSUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLf/AABEIALcBEwMBIgACEQEDEQH/xAAbAAACAwEBAQAAAAAAAAAAAAADBAECBQAGB//EADgQAAEDAgMHAgYBBAEEAwAAAAEAAhEhMQNBUQQSYXGBkfChsQUiwdHh8RMGFDJCUiNiY3IVM1P/xAAZAQADAQEBAAAAAAAAAAAAAAAAAQIDBAX/xAAjEQEBAAICAgICAwEAAAAAAAAAAQIREiEDMUFRE/AicZEy/9oADAMBAAIRAxEAPwD44SJJAgZCSQK2Bv3Vf4/Pt6phrPbzqrttHHhPKbxU01W/40bK17UyGv5XblAdbeZI7sNDDMva6OOjQGorGSLxFam+VO49VAmL+eeykdE4F2tFBP8AlE8Kq+E2nHTzkqNTLTTOZ4RBmetuxVyEjdVWsqJFOyaAByimVax91D2LThsFd0RbWDrznhoqsJFQSONqWNuCYdh+eeVUFtANJzzOZ9OyniYTWn0nt+JUuceHg7T9yifx+ZKWtgz9J90rAC2MwqO85+FHeaW9VX+KQCD/AO1LaVzkCVFgAhXbhoow8qGtxNcs8qaZppmFqKWpTLj3VY47Mq1uU+eALjh+cAnBs4P7+9+SgbPUad/2r4Am1pjdmkzGUjONb91duCE3/bkI38Bg+cKpzAqQOFWqv/HQwJAgm8bsgViwkgdU6/eIH/aALCAAfWXEkyM0LEwKJzBNZr4g33pEaRWZGv8Aj6qoYB6fT6pnEwl26KfLlFzU6+UWVxMsGUiDPuKQI5g+BXc6TMC2QA7dvVNYctM0JrFJFRBPSZQS2gvyyn9eyXEthbhEGOInrUWpKA8cEzuKhbMSYrczAnWK5zRK4gsdIVXC/Hzrl6IxZE1qKZzn51UbtIivTplfroo4mFNqkRMVt28oqbqMQfbTKYrp5kqi2cSJ51j0n1U8T2HuDM+i5X3VyNDZvDsRlThbz3RjgkGCIOkWUhonvmZjKcqKzWRly80uu7HFltVuFMd0I4ZFQSDqDFCCDatZI5J7DB58FbGYYAJOZgmgm9Mpgdgqy8csOVmNYIN51kRxoRU11UOwfwnP46eVVMVkZrK+PTSAYboyHbvCsCqluZBvf8qcNxA3prOtQRBn7cis+Wj0Zw8WnAVrl+6K38kjyvn2SbCmGOHTzurmdo0YdHoDmI4aaZZLhvFrST8oJi14bNL/APG6FiCJiSJuRB4SMjS0qWuioyrXn+UbNYiCCRImTlImtQqtdelfsoLySbSak0HaLdF05e6Wz6VxGTXv53ViOKkGhqROlj5SiltaeppYJbLSMNk58k0MMoWFhxBpHPpzRyJEj2NPpr2K0x18ipGH5bsrNYYhTumM4735WyV8LClXuBRgF1duGLoz8AjJdh4J8HnBGxYE9oyCriARQZV734fhPuwaDVVxNlIyv9f2l2nTKxKmw0ECOigYRAJIpaawDpzTGIzhXL107KWYOVY+qU7KzRRzJNEJ4T+M2JFDXL6d0liJ2JLuOnr1QywTSTQXGcVFDrInPgjObr9kJzFnYYZZl0P29lUt+nqjDBmT68TP2PYrnNFKgE3v8uVZvN6T9FGiLFvWis5gmOGUGsc/yr7qs3By/aOJ7L7nkLk+1g/7eoP2XI4FtzKc0w4aWp3itOdFxZCgNI5Ls9FJs58Nxhh4rHlrSA4EtIlpANoM0yRfj/xAYuK/FDGs3zMMBDRNwAbJEvpPnn3VMVzYzmO/LT8Iyz1NRUxAxJMHWY6IYxCM876Kz3EiMhlTX1QC5cmWbSRYltNc5sbmmYpFOdclAaK+Z/ZUNaXrRQHnzuo5K0ODGmcqBGdKLpFYkisTQ9YpZUJT2Wli4i4V2HKx7i/nsq7w8p5+UNzs1OxocnJXgh0ETumCORqKcvRAw30MZiDa0g+4Rv4SBNYmLRlJ+iexpZiK0KNnoQYmCKGxzM14K7QY1j7x9fVXMj4jMGaM1nfRAwfmIHbNObM2FXNWOImz7NP5Whs2w1itLi3PkeiHs9PzVbGA1o3Wl7N4/wCpmdaxMKpZ8tscfolibHehpePogNcJqFq4OKS2gqVnYzK6eqnl9LuESHDNVcQVb+IU6/v19FUNvIknPMcooq2X4wDhjz0vxQ3YXKP191pYOyF4JEUvJ1tfilcXBiRBBFETLSc/F0ycZl0mQBcTQ6jhNNDXotbHwiAkcbCrxTtc98ZN0RQZ3nsOEV78ENzU0WRSl1LsOfqdajsp2ngSOH90Esi6cdhHS1VfCwh5VT7LiSZh6eyYZgk15k+FONwhmjNwJpaJqeS0xxRYzP4ly0xs50XK+MJnv2gg9xreiF/c+ftNYoBHf2PHiFnvw68dK8VjnnlL7PHQ2Lj7xN61EmTGUnOi6YpTL21QmtIMiZUuxaRSnfL6+6nl9tILiYQjPekyMgKRXWZpGQ1oJuBORVsPGmdaACvomH4kkkxJrQQPSAPZGpezIFk5ZeWVH4doMyMppU0M8gaUqE44RFAZE8qkV90sMStQs7o1oj6qpEH288lMbRitkxThlXITpxQ2Gbiv7t2TugF/HpKs7D1RWjhQX9vsrUJpNtRkJOlJBPa6WjUwSDSKwak9dNKRnRFNvPP0hOhFwNogEQDIj5mzFRaTQ8b3R6GxMJ5gwRaIiaHSbXRmnemGixIAB+UCpipNADcmiFhiTNZM9UYzatKeqIazHGy0tlgTMg5c+PSULYtlLiSGuIk2E9yAFrYPw1xDi4RuGocYyyV4yrxlJf3IBzocs9OXdF+EM/6jXtI3w/eAJkmKnnmp2nYG3cHAExS45cUrg7PvFxbLQzQkurnaPrVVZZ7Od1v7a0h9IggEe1kVmzhzZOvnnFZZ2gy1pdbXKqbwsYtF0pZb065Z6RjsAIA880S7CDdXxtoBMdlOEAP8uiLVSSg7bvDDdunL0z9FPw1382HQF2IyjgLuYYAPMW6hM45aQRkQR3HdYHwfb3bLtAcQaS01IoaHNHJj5f45S/DRZs01qNR95QcXZC7/ABEwa0NOy9Jg4mHtMYmC4DFDQ57HCjoFS0VmMx1WTjfFBAbH8Je353YdH74caRNBH+siYlVuaTdaYTsMNzHTOtYppqqjZicl6bF+I7I926/CdiCK4lBiOzBkU1vKbwvhuDiBpwMRsmf+niHdeTo2m6Z5hT18p4PLs+Hi588KE7Z4ovQ4+zuB3XAhwoQ4GQRlCzHbPB/dPor6+EZYEhg1EVR2YYjKknsu2hhBoKkch21Q2YL3XgdLqpkyuC+9xK5UbhDMqVfJPFmPxaV9kjjltwiPnyVR7c4WGVtZQFuObG09if0qYl5rrW5Vy4Hnn5595/jj8rLVq9ua2vG1PtSFzscyYAiLVplSTfugOoihsyQLCTAyAAmlhUTzS2azsSR6wCD3jTTJVpQx+/I7qrMMTE15cFNWQY71HlQpu1H24TSJsaQIveTSlKd0rjMrSo17IeHtBAi4zP2U/wAhziB6207quUoVqTAnhyTbMAkNkiSSI3hNIi9ADIiuRQNoxgYIpneh4U605IBxDkbD06o3qjo5iYJbeRSa0nz7qMN1ZrSxFxFuXNW/lBZ/ibjdMm+as0CCqvfoCbPWvHWus69VpDHZhNDjBcbA/NFLxbh3osV2Lu13SBTrr3IPdBdtMzIJNhpXgPRTz1NDem23+osQ4gJeQ3MarV2v40Mdwc50NGWZi09gvGOxaRyuBIIm3CvoERjnEgVNYj6JY56V+TKzVr1W3/Fd+CHZ2NuECkLY+HYEs35DXOGlQJsV5n4e44bd2PmBB4yad+SfZtMUJOgraCRrVazyfa8J809tjAHbwvefSe6Ds7zMGyzxtUmpTGHtREwbwOduxoCjre2kyPgAlRIFAZSmHijjNe60sLZ3bm9BtNk7qt8Mr8O2Zrd4UrIv7cVg/wBRYpfjvcTd1RyAHkLZ2Rp32SbmY0oVh/EhJJdN626xxhTS803gD8K25+E8PBgtMhNfFg7FIxt2GukSIILheensstjtZiosb0keo7hb3wba27j8LFnciQ0jO9p4olc+F3/G1kbNiRPKnfjwWrs3xfdIcQDEZQKcrJHAkPJLQ4b1qAGueQFeV0yML5XOABBsDMtrlr17JxGOVnp7f4L8R/v8N+EWTjMYThupJgj5ZJtXOyVxfgeO0VaDWDBseM/dZ/8AQOLGPQxDTM0kzzjPh3v7b43tR2dzg/dLiBAI3gD4bqJyl69OjG7jyGN8GxABDCd4xDQTUa01XYXwl9gx0g1ERBW7t/8AVoGEAxp/lN3G2tGiiy/iP9UYm6x0BuRizjx+yvDPP5hZQn/8Pjf/AJ9wFydb8b2r/wAfnRSr5ZfX7/jPhfr9/wAfMn4uTVcOkQbjz7qBsppAOvYGfSey44Dr+keapSVwl3iCKZ28NVVx7R3qD9Aj4wpBQThEVNBTSYNjF442UZdLgWLXkLITWybUFTFYFAT5qnQwEGR90k7DE91nlNKggH+MOFeB+WpFadaTfWQiuI3YN79c59ku3dr80aUv2tkEU4ZNfKBKUK/xxXLqq4jzYmYpSongRe11Z74EA+BBcybI/o0Odb15qWM0vpdcysCgiBMAZkySLmt+A0RcajvlJjte6RNM4MNbvkNYLxWpurYLcJxDQ5xzmIHa6F8Lw8iJBEcKjh36IuBshlwFh4Ka+aLWbqiW2u3jAgBuX1VWkwBvGlqn5azSOKawGN3iXCQBbXL3XYWBJoK8LeXU8U0rhNyg66d+gHfgntkw2w6L3JNLaT6BamFsjW4ZkfMQb8lnjZ62yvpSqLjxViabtG6GggC7jzNB7enFTjbYYAIig0nKtkntmKWgETvAgC0eouuZi74Bk7wEEkpS2dNfY3ymCONRr5Ctg5RYoOJhPmYigqLRFK8kzgN3Wx/lXTPnpX2TVjD+CC02k3nhy6r1Pw3+o/4cB+GcNh3hAJAmF5V22iZoTnw7DyUPCxHPdAkk5VMlVy03xumhimSXClZAH3vKyfiYEmGkAgZzXO5v6LawGhv/ANhbLoABNgf/AFseYSvx9zQ5rR/r9UvavL/ww8DY6b1ufnFaux4eE0VBJrnFNPesFIOdoYBvx5rt6B/lXyazyT6jjh/GeACLpVu1ETaxHcU84JQ7ReZMggQYqbcwobaTI8+yVzORobLthwiS0yYyM8ckTbPjJfcy81kX46Wled2jEJMBDa501NqKbmczs6e22PHa2hMzcflN4fw/FDhiYuGThBwNCIit4OVF4p20Uje0Tz/jOIMIYbXkA3E3T5tvyS+30Pf+HC4rxL/uuXgGYjyJhxnOp9VyW/7HPEjs+GTmrsvE9D5RMMw4mRPJXeCYoYEkdYm3Idl23HTypSmNhhwoIMCaz17EU58gB2zGKrSdhxUpfFxx01WeUjSF2saAKGf9vx0QXbOHfNHtT6xxTRLYpBnnlQ9+IXfxGCRblSvh7LLW1kcTBaKRWs5RXLzNc15OqbDJuLZ+qj+3qlxNnuw6mnhUYrIEymcTDMpZ+ATwUUFnPuDSCSJbWYtQTpwHdWwHGsVocpjjw5qcbCkzJqSSc5zKIwhojPv2UEe2DbXNg06Gv4Tp2suIcM/OixW1Ht5b9JvY9rggQtMc/iq2a2nCMG9YMTaJy6+pRth2UESTlWo6Qi4lRx42jnqifxQJkUHPSgoRnnSnRaa7LScbaGsMkUAiJ+aYvIAgTlpSc0s3ai6kQL8eXn0U7VhVhvWZvSfVMbIJgbtRemfvqi9qx9s3bWuPy3Fxx+0K7/h8MBBJBdQxBmLRMRevDotx/wAP35IFhSOPnqi4rwWsbuEAOIL/APWgtP8AyjJTxi9MfBDt1wIo4iKUETbTKOqd2bZoIDzuA0ExnmZyVsTbW1YGxuTExJzPWfZZn8ONjYgayXOJ+XPRG5Gkshna8AseRlrkeRRtj21uG5stvXe0AE8pmPTVFwtiePkxnE1yNAIgQe6yzsYNRJO9URPyzbnHupt0vVncVxNr33l0xJ3uQyHsEPa9rL3yaTzpWK8uAWs5m6SC2huPykPjXw9rd1+GRBFRNiLqbaMvHlorhPJIk6C32R8TDBaSDb9JRrkyMeGFvGeqm08MZrsk91V38lOAuquaDFyZMigEUiDJqfmyigvKsWRImnY1+qW2XyuzDLwDAABNRA41Of5S+I9pPyiPqj7OabriY50TGBszDNYIkzr9iiQXv0UGF9KqzWCdVbHeQaWRsA7170iO1U08dnMAu3RG9HCYUouDiloAkCMoK5PcbTxxfCaNfTVEE8CMyjswDz8qomtjAGvsYpWq9Sx4+NZ+1Anl0SmJhxktLEA0QDhBY5YtpSuCDfPkEZ4OtER+D5GekxXI9UU4FL3+kKNNJSDWyc1GI4WlFx2EC90qxhmZqDN1FUjdFxetIpEa63yQ9oxjBaCYJ9raxRNsw4/xNa0plXNJbSYFAJ1g1Ht++0ZTQLOBBMg0MGlRkZHPJCbhze3n5RS8lxmLyT7903hFoBGuZiljTQ0idCs9bBQAxuxZM4exmxaQ7UmNMiPrmqnDbIrExWpAtUxXNM7NVuh0OfJOQCNY+RE/nKpFuCdwsQUkHogMxYsYbUcbzJHVPbOxpb8pWmM+gS2zat13ygtHKJ/CnYNsxAd6e4mQmsWXHI5WhLbRiBoP2+vRFne9qabvi0iBQ59Vl/GsQgA7950PtYX8mM/FfkHXNT+kLFfNyScvO6nLLZzLpfEdIEXXrP6E+PnAxt8htGkQ5oMzMRpWOy8dgMNZOa0cOwOYsplVh729T8f27fBcGNBrUW11heaxPiOlATlnx9Cs/adoxHGrgYEwYyve/JAbMDIH9Kcsttb5N3p6HaNvlkAyYidAq4DA7D3TSszoSCOk/RYTjNAfx5RbGBhkBsgwbXPS3WiTTHybpU7P8xmKQLbsxTv+0zteyENBAmlZ439/VaGNhQM6gQSCIJr1z/CT2naSYaTAH4Ro7JIy9nIBkia2rXtVGxCTE5D5eAk/WVR4AM1qrE1iKc1LLQLoBJFJJpJtzjoqYmNQCyb23Zi1gdumP3HNZb3CZKNoylnsZuITTwr0n9OluC0vdukuECSKCoM6WzjtU+YZjC8VV24jqkmBeNai3v0Rs8MuN29VjY2zPJccKpv80KF5wba4ULx6/QLkcm/5MXqXukEITcMzAmwoTWRfQa9E3h0tPQxeij+MFezlHgY1nEKAR5Hmi0sbBmDSgAtoM4zWZtGCf0srG+OSwNb0UOePt4boWCwjiIOcVNAhkEGQAYJmt/OaitJU42GSggAeecFZ+2wL15WSOJtRJ17/AEWWVkXKLtG0QIIEyayZgxE5D9ylj8xntCpjST8xkUsdF2DiAeeeBZbNdmA2Zk8U7/DQUEAEjPjXX9JZzwcvM/ojirRBtHdOKgDmSZpdWLzIMzAArWgEDsFfHndtJi4Mxzi1jQ5IOGDxSGjZwXRMROcEA0+0d0INcDNY6eaqr8eGwIyPEX9KoX9zZK0H2bb/AKyBoTnw80Sm2Y4OfD286FLufJIaA6jr2gNJkVFQBI45GxVw2mRNuam5FtP81aK2C+soO0NrTRN7Gyxd/iDbnCkRbCbNToe9dOnZWcHCuSca5rRWOAQcbaZ/xF5Gs2Q02SJk7xFBF/OBV3MLZkEekHSNVQggyYprW3oQqMfGXeJnhmkWzmyO+YLf2HGEibCgBK8/gbSBNvOadwsQkbwBAmJreJ9k9tvHlpr/ABPa66keec1hbXV95pev1qE0NqABkczposjbMQl15U1eecOhhN7DReowf6fd/bjaQIZQcJNvZeQ2TFmbevGPstV3xR7cIYe8d2+7JidSLGiR4Zz3Q9r2kQ5r7REDy68699ZFOyY2p7i6k/nzJLlhJJMk95PH1r+0mGefIXZiSRap4eBXxHxUHl55ZThCAZpTRBxfmdFNBSOVNUJ3qF3mq5WxGV/C5AfT8TBBS+MIyz90oz4jlM9ckXF21pC9215E38mGV90ptDSCU1Ihs03hIvBEkSOoI6KuNhTmVnWuNKYbFLsMRotH4d8NdiGGgk8EX4tsBwnbjwAW0Isdfm6m54KK1leZ2nYm1MT552Wa/ZzTdkgWkmBOnVb+OSRutE3IEcpPZoSQaWzlInzqsc5trKySyQfljyUszCNRB7ey3NmaJiJRm7MJk20BrXOxFNKLO4K2wf7dwrF/POSNhktBkVpFTOelItcZCM1ruwRkAenXNI/EHQaC+V6dFNx0ZYvNwOSY2TDk2oaZD1sFnO2k2IA6ImHtzm2iOXvpZTyVKbxmCoIiOqBi4A3fl6yBQ+AeqFibXP8ArH5qEdmIDQ5gcxUHvSOqXVPqlDsZ/wCPacq5yeKEGmbLUxWmzXQK/hL4+GQP8x+fqpsFxVwsEOE52vNa1i9hC7EdAgGom/T89kKXC0jMEX9Pog/MOVrjzJJKeM+qv/Ly85oeJtL6Ak/LbOCa00M+qA5yWwbxcYkSW0mM4n759EtvZ1z5eW7qom3nfqpDO0kjQTA+g7BILF3nnlFdjiNfp1+yrFAIHPMzF1O7z8/KDgrNorE85mPSqqK2GioaKzMQg188qg2lhlrBAiVwfvROWkc/qk8fEaRIyU4LqCOqTTYriKiknqb5eZoT2Fpg0oDXQiR3Bkc1YAB0k0/CVx8Qk85sgql8mB9UaA2HIAeGi1cggvfJqfMvohO9GDiA1+XuuSj7mVyehyrfZjX+YCBImfSMypG0cEADQKf5C0xFePZdvNx8TrNsIFxyRW/EHxAceyyhiGfPoiAkDga6cOtdNCn+SjjGxs3x/Ew3BwNQZnqPso+K/GsXaMTfdiFznRe+gGg/Ky8XHkUJG9VwFGyDSg04pV54aX+yV8lVMYdftkNEEzpFIAEVmZvSKUrWgRtcnK+tPXJJYhK4OpPGAM4rXQC3ekwVlc6uRonEe2oIg8rXpmP2qja33k63kZfdItxjBEDzTT9qr964M2H2SuRnv751JcQMzfsFJ2wvoT1SIwq1vZXZa3leNEuVUPjtJEb2dRMAkTB9+6EMCR/jFb1ral4/aLhOn/U9/ZHcQR/ge5ujUoKf2NCYJAiuQmaEZzHoVUsaP2ivdBrPuEN2Laopnbvml0oZrwRR1vv+ktuRNRwt57oEj0yKndH2GcqbS2K3GIFhHLNDeToFV+LJzIrwJ94VQbVjuls9h9EXEdO6ayBF5ta9gG7ojgrvBkyIzFRNajKtFUAJAJzRNBFBaYsNePqTFIVyKASOVLn2yXOAVRF0gu0jXTLwq4xLCpkGluA9fZALVcuEmJuYtPCfRASx00iZOp9hzVQOikspPLMZzlfziFwrQeQg16bpvM60iK01tX0XC9J4ed1Vroiv41npzVsPFAuJy9/rB6ZoNZra14yuo2p6BVxMWajhx8qgYjiblA2rvXm/tfzooBjP7THvUhQT5CrNQfshIrdneahriNQ1xHoFyGwmFyZba5cY6qhJFVK5dDFUYmVp87IjseBEVXLkjgjceBWeSl+OHSI8r9I7LlykwS3PSn27rjhGC6KAgTxcCR6AqFyRqBlZnoiHDN6a0p7LlyYVhTBEHVcuSCzcQwfeT1pKG7brV9OvnRcuStpifyj2Jp5qgg753W3PTz8LlyLTUGzkidPr+lU4AXLkaLbnt+30UNwxxzgff0XLktGhcXClMq1NTJqZ4ECkWXLlIQBp5mu3c1y5Acf35C4Rp9o/Pl6cuQHOaQQNQD0dBE65KA7MdFy5BpcBkZpyiw6qrHQQaGNbdVC5AQ1VPSylcgI3cgPBX2lDIiQuXIIZmESJE+dVy5cmH//Z");
                background-attachment : fixed;
                background-size : 100% auto;
        }
    </style>
    <script src="//cdn.jsdelivr.net/phaser/2.2.2/phaser.min.js"></script>
</head>
<body>

    <audio autoplay loop>     
        <source src="assets/Pacman theme.mp3" type="audio/mp3">
    </audio>
    
    <script type="text/javascript">
    var game = new Phaser.Game(448, 496, Phaser.AUTO);
    var Pacman = function (game) {
        this.map = null;
        this.layer = null;
        this.pacman = null;
        this.safetile = 14;
        this.gridsize = 16;
        this.speed = 150;
        this.threshold = 3;
        this.marker = new Phaser.Point();
        this.turnPoint = new Phaser.Point();
        this.directions = [ null, null, null, null, null ];
        this.opposites = [ Phaser.NONE, Phaser.RIGHT, Phaser.LEFT, Phaser.DOWN, Phaser.UP ];
        this.current = Phaser.NONE;
        this.turning = Phaser.NONE;
      };
    Pacman.prototype = {
        init: function () {
            this.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
            this.scale.pageAlignHorizontally = true;
            this.scale.pageAlignVertically = true;
            Phaser.Canvas.setImageRenderingCrisp(this.game.canvas);
            this.physics.startSystem(Phaser.Physics.ARCADE);
        },
        preload: function () {
            //  We need this because the assets are on github pages
            //  Remove the next 2 lines if running locally
            this.load.baseURL = 'https://p13sian.github.io/pacman/';
            this.load.crossOrigin = 'anonymous';
            this.load.image('dot', 'assets/dot.png');
            this.load.image('tiles', 'assets/pacman-tilesnew.png.png');
            this.load.spritesheet('pacman', 'assets/monsteraki.png', 32, 32);
            this.load.tilemap('map', 'assets/pacman-mapnew.json', null, Phaser.Tilemap.TILED_JSON);
            //  Needless to say, graphics (C)opyright Namco
        },
        create: function () {
            this.map = this.add.tilemap('map');
            this.map.addTilesetImage('pacman-tiles', 'tiles');
            this.layer = this.map.createLayer('Pacman');
            this.dots = this.add.physicsGroup();
            this.scoreText = game.add.text(0, 500, 'Score: 0', { fontSize: '34px Arial', fill: 'red' });
            this.map.createFromTiles(7, this.safetile, 'dot', this.layer, this.dots);
            //  The dots will need to be offset by 6px to put them back in the middle of the grid
            this.dots.setAll('x', 6, false, false, 1);
            this.dots.setAll('y', 6, false, false, 1);
            //  Pacman should collide with everything except the safe tile
            this.map.setCollisionByExclusion([this.safetile], true, this.layer);
            //  Position Pacman at grid location 14x17 (the +8 accounts for his anchor)
            this.pacman = this.add.sprite((14 * 16) + 8, (17 * 16) + 8, 'pacman', 0);
            this.pacman.anchor.set(0.5);
            this.pacman.animations.add('munch', [0, 1, 2, 1], 20, true);
            this.physics.arcade.enable(this.pacman);
            this.pacman.body.setSize(16, 16, 0, 0);
            this.cursors = this.input.keyboard.createCursorKeys();
            this.pacman.play('munch');
            this.move(Phaser.LEFT);
        },
        checkKeys: function () {
            if (this.cursors.left.isDown && this.current !== Phaser.LEFT)
            {
                this.checkDirection(Phaser.LEFT);
            }
            else if (this.cursors.right.isDown && this.current !== Phaser.RIGHT)
            {
                this.checkDirection(Phaser.RIGHT);
            }
            else if (this.cursors.up.isDown && this.current !== Phaser.UP)
            {
                this.checkDirection(Phaser.UP);
            }
            else if (this.cursors.down.isDown && this.current !== Phaser.DOWN)
            {
                this.checkDirection(Phaser.DOWN);
            }
            else
            {
                //  This forces them to hold the key down to turn the corner
                this.turning = Phaser.NONE;
            }
        },
        checkDirection: function (turnTo) {
            if (this.turning === turnTo || this.directions[turnTo] === null || this.directions[turnTo].index !== this.safetile)
            {
                //  Invalid direction if they're already set to turn that way
                //  Or there is no tile there, or the tile isn't index 1 (a floor tile)
                return;
            }
            //  Check if they want to turn around and can
            if (this.current === this.opposites[turnTo])
            {
                this.move(turnTo);
            }
            else
            {
                this.turning = turnTo;
                this.turnPoint.x = (this.marker.x * this.gridsize) + (this.gridsize / 2);
                this.turnPoint.y = (this.marker.y * this.gridsize) + (this.gridsize / 2);
            }
        },
        turn: function () {
            var cx = Math.floor(this.pacman.x);
            var cy = Math.floor(this.pacman.y);
            //  This needs a threshold, because at high speeds you can't turn because the coordinates skip past
            if (!this.math.fuzzyEqual(cx, this.turnPoint.x, this.threshold) || !this.math.fuzzyEqual(cy, this.turnPoint.y, this.threshold))
            {
                return false;
            }
            //  Grid align before turning
            this.pacman.x = this.turnPoint.x;
            this.pacman.y = this.turnPoint.y;
            this.pacman.body.reset(this.turnPoint.x, this.turnPoint.y);
            this.move(this.turning);
            this.turning = Phaser.NONE;
            return true;
        },
        move: function (direction) {
            var speed = this.speed;
            if (direction === Phaser.LEFT || direction === Phaser.UP)
            {
                speed = -speed;
            }
            if (direction === Phaser.LEFT || direction === Phaser.RIGHT)
            {
                this.pacman.body.velocity.x = speed;
            }
            else
            {
                this.pacman.body.velocity.y = speed;
            }
            //  Reset the scale and angle (Pacman is facing to the right in the sprite sheet)
            this.pacman.scale.x = 1;
            this.pacman.angle = 0;
            if (direction === Phaser.LEFT)
            {
                this.pacman.scale.x = -1;
            }
            else if (direction === Phaser.UP)
            {
                this.pacman.angle = 270;
            }
            else if (direction === Phaser.DOWN)
            {
                this.pacman.angle = 90;
            }
            this.current = direction;
        },
        eatDot: function (pacman, dot) {
            dot.kill();
            var audio = new Audio('assets/Eat Sound Effect.mp3'); 
            audio.play()
           
            if (this.dots.total === 0)
            {
                this.dots.callAll('revive');
            }
        },
        update: function () {
          
            this.physics.arcade.collide(this.pacman, this.layer);
            this.physics.arcade.overlap(this.pacman, this.dots, this.eatDot, null, this);
            this.marker.x = this.math.snapToFloor(Math.floor(this.pacman.x), this.gridsize) / this.gridsize;
            this.marker.y = this.math.snapToFloor(Math.floor(this.pacman.y), this.gridsize) / this.gridsize;
            //  Update our grid sensors
            this.directions[1] = this.map.getTileLeft(this.layer.index, this.marker.x, this.marker.y);
            this.directions[2] = this.map.getTileRight(this.layer.index, this.marker.x, this.marker.y);
            this.directions[3] = this.map.getTileAbove(this.layer.index, this.marker.x, this.marker.y);
            this.directions[4] = this.map.getTileBelow(this.layer.index, this.marker.x, this.marker.y);
            this.checkKeys();
            if (this.turning !== Phaser.NONE)
            {
                this.turn();
            }
        }
    };
    game.state.add('Game', Pacman, true);
    </script>

</body>
</html>
